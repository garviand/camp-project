(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(t,e,a){},16:function(t,e,a){},17:function(t,e,a){"use strict";a.r(e);var n=a(0),c=a.n(n),o=a(3),i=a.n(o),s=(a(15),a(4)),l=a(5),r=a(7),u=a(6),d=a(1),m=a(8),f={get:function(t,e,a){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if("OK"!==n.statusText)return void alert("Error retreiving contacts");a(JSON.parse(n.responseText))}};var c=Object.keys(e).map(function(t){return t+"="+e[t]}),o="";c.length>0&&(o="?"+c.join("&")),n.open("GET","https://cors-anywhere.herokuapp.com/"+t+o,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Api-Token","0f7e5c9167768f6bb0a6e09e335ce464da7cb5e7008b989f0057266c26342424a4d8d3e5"),n.send()}},p=(a(16),function(t){function e(t){var a;return Object(s.a)(this,e),(a=Object(r.a)(this,Object(u.a)(e).call(this,t))).state={dataLoaded:!1,contacts:null,deals:null,locations:null,tags:null},a.compileDeals=a.compileDeals.bind(Object(d.a)(a)),a.compileLocations=a.compileLocations.bind(Object(d.a)(a)),a.compileTags=a.compileTags.bind(Object(d.a)(a)),a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.fetchContacts().then(this.compileDeals).then(this.compileLocations).then(this.compileTags).then(function(){t.setState({dataLoaded:!0})})}},{key:"fetchContacts",value:function(){var t=this;return new Promise(function(e,a){f.get("https://lamppoststudios.api-us1.com/api/3/contacts",{include:"contactTags.tag,deals,contactData",limit:100},function(a){t.setState({contacts:a.contacts,tags:a.tags},function(){e(a)})})})}},{key:"compileDeals",value:function(t){var e=this;return new Promise(function(a,n){var c={};t.deals.forEach(function(t){t.contact in c||(c[t.contact]={count:0,value:0}),c[t.contact].count++,c[t.contact].value+=parseInt(t.value)}),e.setState({deals:c},function(){a(t)})})}},{key:"compileLocations",value:function(t){var e=this;return new Promise(function(a,n){var c={};t.contactData.forEach(function(t){t.contact in c||(c[t.contact]={city:t.geoCity,state:t.geoState,country:t.geoCountry2})}),e.setState({locations:c},function(){a(t)})})}},{key:"compileTags",value:function(t){var e=this;return new Promise(function(a,n){var c={};t.tags.forEach(function(t){t.id in c||(c[t.id]=t.tag)});var o={};t.contactTags.forEach(function(t){t.contact in o||(o[t.contact]=[]),o[t.contact].push(c[t.tag])}),e.setState({tags:o},function(){a(t)})})}},{key:"render",value:function(){var t=this;return c.a.createElement("div",{className:"app"},c.a.createElement("table",null,c.a.createElement("tbody",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Contact"),c.a.createElement("th",null,"Total Value"),c.a.createElement("th",null,"Location"),c.a.createElement("th",null,"Deals"),c.a.createElement("th",null,"Tags")),this.state.dataLoaded&&this.state.contacts.map(function(e){var a=0,n=0;e.id in t.state.deals&&(a=t.state.deals[e.id].value,n=t.state.deals[e.id].count);var o="";if(e.id in t.state.locations){var i=t.state.locations[e.id];o=["city","state","country"].filter(function(t){return i[t].trim().length>0}).map(function(t){return i[t]}).join(", ")}var s="";return e.id in t.state.tags&&(s=t.state.tags[e.id].join(", ")),c.a.createElement("tr",{key:e.email},c.a.createElement("td",null,e.firstName," ",e.lastName),c.a.createElement("td",null,"$",a),c.a.createElement("td",null,o),c.a.createElement("td",null,n),c.a.createElement("td",null,s))}))))}}]),e}(c.a.Component));i.a.render(c.a.createElement(p,null),document.getElementById("root"))},9:function(t,e,a){t.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.fdc784a4.chunk.js.map