{"version":3,"sources":["Config.js","Utils.js","App.js","index.js"],"names":["Config","URL_PREFIX","AC_API_TOKEN","Utils","get","url","params","cb","xhr","XMLHttpRequest","onreadystatechange","readyState","DONE","statusText","alert","JSON","parse","responseText","paramList","Object","keys","map","key","_params","length","join","open","setRequestHeader","send","App","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","dataLoaded","contacts","deals","locations","tags","compileDeals","bind","assertThisInitialized","compileLocations","compileTags","_this2","fetchContacts","then","setState","_this3","Promise","resolve","reject","include","limit","response","_this4","forEach","deal","contact","count","value","parseInt","_this5","contactData","data","city","geoCity","geoState","country","geoCountry2","_this6","tag","id","mappings","contactTags","contactTag","push","_this7","react_default","a","createElement","className","location","_location","filter","field","trim","email","firstName","lastName","toLocaleString","React","Component","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.fc49e33b.chunk.js","sourcesContent":["const Config = {\n  URL_PREFIX: 'https://cors-anywhere.herokuapp.com/',\n  AC_API_TOKEN: '0f7e5c9167768f6bb0a6e09e335ce464da7cb5e7008b989f0057266c26342424a4d8d3e5'\n}\n\nexport default Config","import Config from './Config';\n\nconst Utils = {\n  \n  get: function(url, params, cb) {\n    const xhr = new XMLHttpRequest();\n    xhr.onreadystatechange = function() {\n      if (xhr.readyState === XMLHttpRequest.DONE) {\n        if (xhr.statusText !== 'OK') {\n          alert('Error retreiving contacts');\n          return\n        }\n        cb(JSON.parse(xhr.responseText));\n      }\n    }\n    let paramList = Object.keys(params).map(function(key){\n      let param = params[key];\n      return key + '=' + param\n    });\n    let _params = ''\n    if (paramList.length > 0) {\n      _params = '?' + paramList.join('&')\n    }\n    xhr.open('GET', Config.URL_PREFIX + url + _params, true);\n    xhr.setRequestHeader('Content-Type', 'application/json');\n    xhr.setRequestHeader('Api-Token', Config.AC_API_TOKEN);\n    xhr.send();\n  }\n\n}\n\nexport default Utils;","import React from 'react';\nimport Utils from './Utils';\nimport './App.css';\n\nclass App extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      dataLoaded: false,\n      contacts: null,\n      deals: null,\n      locations: null,\n      tags: null\n    };\n    this.compileDeals = this.compileDeals.bind(this);\n    this.compileLocations = this.compileLocations.bind(this);\n    this.compileTags = this.compileTags.bind(this);\n  }\n\n  componentDidMount() {\n    // Sequentially load and compile all data, then set loaded to true\n    this.fetchContacts()\n    .then(this.compileDeals)\n    .then(this.compileLocations)\n    .then(this.compileTags)\n    .then(() => {\n      this.setState({\n        dataLoaded: true\n      });\n    })\n  }\n\n  fetchContacts() {\n    return new Promise((resolve, reject) => {\n      const url = 'https://lamppoststudios.api-us1.com/api/3/contacts';\n      const params = {\n        include: 'contactTags.tag,deals,contactData',\n        limit: 100\n      }\n      Utils.get(url, params, (response) => {\n        this.setState({\n          contacts: response.contacts\n        }, () => {\n          resolve(response);\n        });\n      });\n    })\n  }\n\n  compileDeals(response) {\n    return new Promise((resolve, reject) => {\n      let deals = {}\n      response.deals.forEach((deal) => {\n        // If contact deals object doesn't exist, create\n        if (!(deal.contact in deals)) {\n          deals[deal.contact] = {\n            count: 0,\n            value: 0\n          }\n        }\n        // Increment deal count and add value to total value\n        deals[deal.contact].count++\n        deals[deal.contact].value += parseInt(deal.value)\n      });\n      this.setState({\n        deals: deals\n      }, () => {\n        resolve(response);\n      });\n    })\n  }\n\n  compileLocations(response) {\n    return new Promise((resolve, reject) => {\n      let locations = {}\n      response.contactData.forEach((data) => {\n        // If contact locations object doesn't exist, create\n        if (!(data.contact in locations)) {\n          locations[data.contact] = {\n            city: data.geoCity,\n            state: data.geoState,\n            country: data.geoCountry2\n          }\n        }\n      });\n      this.setState({\n        locations: locations\n      }, () => {\n        resolve(response);\n      });\n    })\n  }\n\n  compileTags(response) {\n    return new Promise((resolve, reject) => {\n      // First, compile tags by id\n      let tags = {}\n      response.tags.forEach((tag) => {\n        // If tag object doesn't exist, create\n        if (!(tag.id in tags)) {\n          tags[tag.id] = tag.tag\n        }\n      });\n      // Next, add mappings to specific contacts\n      let mappings = {}\n      response.contactTags.forEach((contactTag) => {\n        // If mapping object doesn't exist, create\n        if (!(contactTag.contact in mappings)) {\n          mappings[contactTag.contact] = []\n        }\n        // Add tag value to list\n        mappings[contactTag.contact].push(tags[contactTag.tag])\n      });\n      this.setState({\n        tags: mappings\n      }, () => {\n        resolve(response);\n      });\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <table className=\"contact_table\">\n          <thead>\n            <tr className=\"contact_table-header\">\n              <th>Contact</th>\n              <th>Total Value</th>\n              <th>Location</th>\n              <th className=\"contact_table-cell-centered\">Deals</th>\n              <th>Tags</th>\n            </tr>\n          </thead>\n          <tbody>\n            {this.state.dataLoaded &&\n              this.state.contacts.map((contact) => {\n                let value = 0;\n                let deals = 0;\n                if (contact.id in this.state.deals) {\n                  value = this.state.deals[contact.id].value\n                  deals = this.state.deals[contact.id].count\n                }\n                let location = '';\n                if (contact.id in this.state.locations) {\n                  let _location = this.state.locations[contact.id]\n                  let locationSegments = ['city', 'state', 'country'].filter(function(field) {\n                    return _location[field].trim().length > 0;\n                  }).map(function(field) {\n                    return _location[field];\n                  })\n                  location = locationSegments.join(', ')\n                }\n                let tags = '';\n                if (contact.id in this.state.tags) {\n                  tags = this.state.tags[contact.id].join(', ')\n                }\n                return (\n                  <tr key={contact.email} className=\"contact_table-row\">\n                    <td className=\"contact_table-cell-name\">{contact.firstName} {contact.lastName}</td>\n                    <td>${value.toLocaleString()}</td>\n                    <td className=\"contact_table-cell-location\">{location}</td>\n                    <td className=\"contact_table-cell-centered\">{deals}</td>\n                    <td className=\"contact_table-cell-tags\">{tags}</td>\n                  </tr>\n                );\n              })\n            }\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}