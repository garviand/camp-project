(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(t,e,a){},16:function(t,e,a){},17:function(t,e,a){"use strict";a.r(e);var n=a(0),c=a.n(n),o=a(3),s=a.n(o),l=(a(15),a(4)),i=a(5),r=a(7),u=a(6),m=a(1),d=a(8),f={URL_PREFIX:"https://cors-anywhere.herokuapp.com/",AC_API_TOKEN:"0f7e5c9167768f6bb0a6e09e335ce464da7cb5e7008b989f0057266c26342424a4d8d3e5"},p={get:function(t,e,a){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if("OK"!==n.statusText)return void alert("Error retreiving contacts");a(JSON.parse(n.responseText))}};var c=Object.keys(e).map(function(t){return t+"="+e[t]}),o="";c.length>0&&(o="?"+c.join("&")),n.open("GET",f.URL_PREFIX+t+o,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Api-Token",f.AC_API_TOKEN),n.send()}},h=(a(16),function(t){function e(t){var a;return Object(l.a)(this,e),(a=Object(r.a)(this,Object(u.a)(e).call(this,t))).state={dataLoaded:!1,contacts:null,deals:null,locations:null,tags:null},a.compileDeals=a.compileDeals.bind(Object(m.a)(a)),a.compileLocations=a.compileLocations.bind(Object(m.a)(a)),a.compileTags=a.compileTags.bind(Object(m.a)(a)),a}return Object(d.a)(e,t),Object(i.a)(e,[{key:"componentDidMount",value:function(){var t=this;this.fetchContacts().then(this.compileDeals).then(this.compileLocations).then(this.compileTags).then(function(){t.setState({dataLoaded:!0})})}},{key:"fetchContacts",value:function(){var t=this;return new Promise(function(e,a){p.get("https://lamppoststudios.api-us1.com/api/3/contacts",{include:"contactTags.tag,deals,contactData",limit:100},function(a){t.setState({contacts:a.contacts},function(){e(a)})})})}},{key:"compileDeals",value:function(t){var e=this;return new Promise(function(a,n){var c={};t.deals.forEach(function(t){t.contact in c||(c[t.contact]={count:0,value:0}),c[t.contact].count++,c[t.contact].value+=parseInt(t.value)}),e.setState({deals:c},function(){a(t)})})}},{key:"compileLocations",value:function(t){var e=this;return new Promise(function(a,n){var c={};t.contactData.forEach(function(t){t.contact in c||(c[t.contact]={city:t.geoCity,state:t.geoState,country:t.geoCountry2})}),e.setState({locations:c},function(){a(t)})})}},{key:"compileTags",value:function(t){var e=this;return new Promise(function(a,n){var c={};t.tags.forEach(function(t){t.id in c||(c[t.id]=t.tag)});var o={};t.contactTags.forEach(function(t){t.contact in o||(o[t.contact]=[]),o[t.contact].push(c[t.tag])}),e.setState({tags:o},function(){a(t)})})}},{key:"render",value:function(){var t=this;return c.a.createElement("div",{className:"app"},c.a.createElement("table",{className:"contact_table"},c.a.createElement("thead",null,c.a.createElement("tr",{className:"contact_table-header"},c.a.createElement("th",null,"Contact"),c.a.createElement("th",null,"Total Value"),c.a.createElement("th",null,"Location"),c.a.createElement("th",{className:"contact_table-cell-centered"},"Deals"),c.a.createElement("th",null,"Tags"))),c.a.createElement("tbody",null,this.state.dataLoaded&&this.state.contacts.map(function(e){var a=0,n=0;e.id in t.state.deals&&(a=t.state.deals[e.id].value,n=t.state.deals[e.id].count);var o="";if(e.id in t.state.locations){var s=t.state.locations[e.id];o=["city","state","country"].filter(function(t){return s[t].trim().length>0}).map(function(t){return s[t]}).join(", ")}var l="";return e.id in t.state.tags&&(l=t.state.tags[e.id].join(", ")),c.a.createElement("tr",{key:e.email,className:"contact_table-row"},c.a.createElement("td",{className:"contact_table-cell-name"},e.firstName," ",e.lastName),c.a.createElement("td",null,"$",a.toLocaleString()),c.a.createElement("td",{className:"contact_table-cell-location"},o),c.a.createElement("td",{className:"contact_table-cell-centered"},n),c.a.createElement("td",{className:"contact_table-cell-tags"},l))}))))}}]),e}(c.a.Component));s.a.render(c.a.createElement(h,null),document.getElementById("root"))},9:function(t,e,a){t.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.fc49e33b.chunk.js.map